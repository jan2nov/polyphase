(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     13919,        399]
NotebookOptionsPosition[     12668,        353]
NotebookOutlinePosition[     13011,        368]
CellTagsIndexPosition[     12968,        365]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Test signals", "Title",
 CellChangeTimes->{{3.590995047576013*^9, 3.590995053784824*^9}}],

Cell[CellGroupData[{

Cell["Data import and settings", "Section",
 CellChangeTimes->{{3.5910328474893656`*^9, 3.5910328539115367`*^9}, {
  3.5910349897860413`*^9, 3.5910350152092257`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Vivaldi1.flac\>\""}],
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opt", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", "\"\<Options\>\""}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"extracts", " ", "sample", " ", "rate"}], ",", " ", "depth", ",", 
    " ", 
    RowBox[{
    "#", " ", "of", " ", "channels", " ", "from", " ", "sound", " ", "file", 
     " ", "header"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chan", "=", 
   RowBox[{"\"\<AudioChannels\>\"", "/.", 
    RowBox[{"{", 
     RowBox[{"opt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "}"}]}]}], ";", 
  RowBox[{"dep", "=", 
   RowBox[{"\"\<SampleDepth\>\"", "/.", 
    RowBox[{"{", 
     RowBox[{"opt", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "}"}]}]}], ";", 
  RowBox[{"rate", "=", 
   RowBox[{"\"\<SampleRate\>\"", "/.", 
    RowBox[{"{", 
     RowBox[{"opt", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"signal", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Import", "[", 
      RowBox[{"file", ",", "\"\<Data\>\""}], "]"}]}]}], ";", 
   RowBox[{"(*", " ", 
    RowBox[{"loads", " ", "the", " ", "signal", " ", "data"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"leno", "=", 
    RowBox[{"Length", "[", "signal", "]"}]}], ";", 
   RowBox[{"lenp", "=", 
    RowBox[{"2", "^", 
     RowBox[{"Ceiling", "[", 
      RowBox[{"Log2", "[", "leno", "]"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"nearest", " ", "greater", " ", "or", " ", "equal", " ", 
    RowBox[{"2", "^", "n"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"signal", "=", 
    RowBox[{"PadRight", "[", 
     RowBox[{"signal", ",", "lenp"}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"padding", " ", "if", " ", "necessary"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Original Length = \>\"", ",", "leno"}], "]"}], ";", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Padded Length   = \>\"", ",", "lenp"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.510466691328125*^9, 3.510466697546875*^9}, {
   3.51046676009375*^9, 3.51046692153125*^9}, 3.510467007734375*^9, {
   3.51046729609375*^9, 3.51046732309375*^9}, {3.510467373875*^9, 
   3.510467375375*^9}, {3.51046746503125*^9, 3.510467467765625*^9}, {
   3.5114558995*^9, 3.5114559311875*^9}, 3.5734519056062827`*^9, {
   3.5734523303257895`*^9, 3.573452357210827*^9}, {3.57345307229283*^9, 
   3.5734530749778337`*^9}, {3.591030784085428*^9, 3.5910307906013856`*^9}, {
   3.591031015482193*^9, 3.591031024373275*^9}, {3.5910311308731513`*^9, 
   3.591031207470832*^9}, {3.591031240347519*^9, 3.5910312581296806`*^9}, {
   3.5910318844298463`*^9, 3.591031970152999*^9}, 3.591032164833556*^9, {
   3.591032535240934*^9, 3.591032580328393*^9}, {3.591033608031415*^9, 
   3.5910336209382963`*^9}, {3.5910340035960054`*^9, 3.591034062286479*^9}, {
   3.5910342624050045`*^9, 3.591034417319166*^9}, {3.591034934173811*^9, 
   3.5910349778323064`*^9}, {3.5910350221783295`*^9, 3.5910350233815155`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlay", ",", 
    RowBox[{"SampleRate", "\[Rule]", "rate"}], ",", 
    RowBox[{"SampleDepth", "\[Rule]", "dep"}], ",", 
    RowBox[{"PlayRange", "\[Rule]", "All"}]}], "]"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{"default", " ", "options", " ", "for", " ", "playing"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLinePlot", ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "rate"}], "/", "2"}], ",", 
       RowBox[{"rate", "/", "2"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<f [Hz]\>\"", ",", "None"}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogPlot", ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "rate"}], "/", "2"}], ",", 
       RowBox[{"rate", "/", "2"}]}], "}"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<f [Hz]\>\"", ",", "None"}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Fourier", ",", 
    RowBox[{"FourierParameters", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "signal", " ", "processing", " ", "settings", " ", "for", " ", "DFT"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5910350480859146`*^9, 3.591035050789175*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The noisifying function", "Section",
 CellChangeTimes->{{3.5910328669434547`*^9, 3.5910328821473565`*^9}, {
  3.5910338700891256`*^9, 3.5910338751831665`*^9}}],

Cell["\<\
A simple \[OpenCurlyDoubleQuote]noisify\[CloseCurlyDoubleQuote] function \
definition follows. It taken 3 arguments:\
\>", "Text",
 CellChangeTimes->{{3.5910328879601946`*^9, 3.5910329178679423`*^9}}],

Cell[CellGroupData[{

Cell["Argument 1: sampled signal", "Item",
 CellChangeTimes->{{3.591032927055911*^9, 3.591032937994012*^9}}],

Cell["\<\
Argument 2: noise type. Currently two options implemented: 1 = uniformly \
distributed noise is added, 2 = normally distributed noise is added\
\>", "Item",
 CellChangeTimes->{{3.591032927055911*^9, 3.5910329424317045`*^9}, {
  3.5910330770902762`*^9, 3.5910331652666636`*^9}}],

Cell["\<\
Argument 3: For noise type 1: maximum noise amplitude (uniform variate in \
interval [-arg3, arg3]); for noise type 2: standard deviation\
\>", "Item",
 CellChangeTimes->{{3.591032927055911*^9, 3.5910329424317045`*^9}, {
  3.5910330770902762`*^9, 3.591033298554761*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisify", "[", 
   RowBox[{"signal_List", ",", "noiseType_Integer", ",", "amp_Real"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", "signal", "]"}]}], ",", "noisy"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"noiseType", "\[Equal]", "1"}], ",", 
       RowBox[{"noisy", "=", 
        RowBox[{"signal", "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "amp"}], ",", "amp"}], "}"}], ",", "len"}], 
          "]"}]}]}], ",", 
       RowBox[{"noiseType", "\[Equal]", "2"}], ",", 
       RowBox[{"noisy", "=", 
        RowBox[{"signal", "+", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{
           RowBox[{"NormalDistribution", "[", 
            RowBox[{"0", ",", "amp"}], "]"}], ",", "len"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"noiseType", " ", "\[NotEqual]", "1"}], "\[And]", 
        RowBox[{"noiseType", "\[NotEqual]", "2"}]}], ",", 
       RowBox[{"noisy", "=", "signal"}]}], "]"}], ";", "noisy"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5910312698959093`*^9, 3.5910312977723455`*^9}, {
  3.591031364322631*^9, 3.591031443920478*^9}, {3.5910322124911165`*^9, 
  3.5910322350235233`*^9}, {3.591032313047637*^9, 3.5910323649721737`*^9}, {
  3.5910323962550287`*^9, 3.591032505213747*^9}, {3.5910326060953364`*^9, 
  3.5910326064547276`*^9}, {3.5910327072657223`*^9, 3.591032755647623*^9}, {
  3.5910327857004786`*^9, 3.591032792247693*^9}, {3.5910329592919407`*^9, 
  3.5910330617347045`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Playing sounds", "Section",
 CellChangeTimes->{{3.59103388816817*^9, 3.5910339008406954`*^9}}],

Cell["\<\
First run the noisifying function to add some Gaussian noise and save the \
result:\
\>", "Text",
 CellChangeTimes->{{3.5910339135444746`*^9, 3.5910339594062386`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisySignal", "=", 
   RowBox[{"noisify", "[", 
    RowBox[{"signal", ",", "2", ",", "0.1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5910314569680133`*^9, 3.5910314821099253`*^9}, {
  3.591032598766836*^9, 3.5910325990481*^9}, {3.591032648763851*^9, 
  3.5910326544828835`*^9}, {3.5910326952963953`*^9, 3.591032695890143*^9}, {
  3.5910327634917755`*^9, 3.59103281838407*^9}, {3.591032945322477*^9, 
  3.591032946635046*^9}, {3.5910333219878583`*^9, 3.59103333490485*^9}, {
  3.5910333805255485`*^9, 3.5910334095670347`*^9}}],

Cell["\<\
Now you can play both, the original and noisified sound:\
\>", "Text",
 CellChangeTimes->{{3.591034162332882*^9, 3.5910341881310806`*^9}}],

Cell[BoxData[
 RowBox[{"Row", "[", 
  RowBox[{"ListPlay", "/@", 
   RowBox[{"{", 
    RowBox[{"signal", ",", "noisySignal"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.591034121591899*^9, 3.591034140327228*^9}, {
  3.5910341920687437`*^9, 3.591034231023868*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fourier analysis", "Section",
 CellChangeTimes->{{3.5910344500395947`*^9, 3.5910344539773006`*^9}}],

Cell["\<\
First carry out the calculation of DFTs (the spectrum being wrapped around \
cyclically by half length):\
\>", "Text",
 CellChangeTimes->{{3.5910346367366753`*^9, 3.59103465261249*^9}, {
  3.5910350914676266`*^9, 3.5910351367043047`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"spectrum", "=", 
   RowBox[{"RotateLeft", "[", 
    RowBox[{
     RowBox[{"Fourier", "[", "signal", "]"}], ",", 
     RowBox[{
      RowBox[{"lenp", "/", "2"}], "+", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisySpectrum", "=", 
   RowBox[{"RotateLeft", "[", 
    RowBox[{
     RowBox[{"Fourier", "[", "noisySignal", "]"}], ",", 
     RowBox[{
      RowBox[{"lenp", "/", "2"}], "+", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5910335623727865`*^9, 3.5910335900460863`*^9}, 
   3.591033625907296*^9, {3.591033763117462*^9, 3.591033768805292*^9}, {
   3.5910344720876045`*^9, 3.5910344906198025`*^9}, {3.5910348936717377`*^9, 
   3.591034906719279*^9}, 3.5910350884049363`*^9}],

Cell["\<\
Here is amplitude spectrum of the original sound (left linear, right \
logarithmic)\
\>", "Text",
 CellChangeTimes->{{3.5910351491893005`*^9, 3.591035188300685*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"Abs", "[", "spectrum", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"ListLinePlot", ",", "ListLogPlot"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5910345331376095`*^9, 3.591034617938835*^9}}],

Cell["\<\
Here is amplitude spectrum of the noisified sound (left linear, right \
logarithmic)\
\>", "Text",
 CellChangeTimes->{{3.5910351491893005`*^9, 3.5910352130207047`*^9}}],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"Abs", "[", "noisySpectrum", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"ListLinePlot", ",", "ListLogPlot"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5910345331376095`*^9, 3.591034617938835*^9}, {
  3.5910352205679626`*^9, 3.591035231318514*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1020, 761},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 95, 1, 101, "Title"],
Cell[CellGroupData[{
Cell[699, 27, 166, 2, 86, "Section"],
Cell[868, 31, 3374, 80, 172, "Input"],
Cell[4245, 113, 1914, 52, 152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6196, 170, 165, 2, 86, "Section"],
Cell[6364, 174, 210, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[6599, 182, 108, 1, 29, "Item"],
Cell[6710, 185, 287, 5, 29, "Item"],
Cell[7000, 192, 280, 5, 29, "Item"]
}, Open  ]],
Cell[7295, 200, 1691, 41, 112, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9023, 246, 100, 1, 86, "Section"],
Cell[9126, 249, 177, 4, 30, "Text"],
Cell[9306, 255, 569, 10, 31, "Input"],
Cell[9878, 267, 148, 3, 30, "Text"],
Cell[10029, 272, 268, 6, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10334, 283, 105, 1, 86, "Section"],
Cell[10442, 286, 248, 5, 30, "Text"],
Cell[10693, 293, 758, 19, 52, "Input"],
Cell[11454, 314, 175, 4, 30, "Text"],
Cell[11632, 320, 384, 10, 31, "Input"],
Cell[12019, 332, 178, 4, 30, "Text"],
Cell[12200, 338, 440, 11, 31, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
